<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title> lc.js test </title>
    <link rel="stylesheet" href="style.css">
    <script src="../lc.js"></script>
    <script lang="javascript">
     function onRunButtonClicked() {
       var src = document.getElementById("text-source").value;
       var n = Date.now();
       var opt = {predefined: true, timeLimit: 1};
       var output = lc.run("<TEXT>", src, opt);
       document.getElementById("text-result").value = output;
       var t = Date.now();
       document.getElementById("text-time").textContent = "[" + (t - n) / 1000 + "s]";
     }

     window.onload = () => {
       document.getElementById('text-source').addEventListener(
         'keydown',
         function(e) {
           let input = e.target;
           let selStartPos = input.selectionStart;
           let selEndPos = input.selectionEnd;
           let code = input.value;
           if(e.key === '\\') {
             e.preventDefault();
             input.value = code.substring(0, selStartPos) +
                           'Î»' +
                           code.substring(selEndPos);
             input.selectionStart = input.selectionEnd = selStartPos + 1;
           } else if(e.key === '(') {
             e.preventDefault();
             input.value = code.substring(0, selStartPos) +
                           '(' + code.substring(selStartPos, selEndPos) + ')' +
                           code.substring(selEndPos);
             input.selectionStart = input.selectionEnd = selStartPos + 1;
           } else if(e.key === ')' && selStartPos == selEndPos) {
             if(code.substring(selStartPos, selStartPos + 1) === ')') {
               e.preventDefault();
               input.selectionStart = input.selectionEnd = selStartPos + 1;
             }
           }
         }, false);
     };
    </script>
  </head>
  <body>
    <div id="menu">
      <span>LFLC : lc.js</span>
      <span class="menu-item" onclick="onRunButtonClicked()">Run</span>
    </div>
    <div id="contents">
      <div id="side">
        Options
        <input type="checkbox" id="cb1">
      </div>
      <div id="main">
        <div id="editor">
          <div class="content-title">[Source]</div>
          <textarea id="text-source" rows="10"></textarea>
        </div>
        <div id="result">
          <div class="content-title">[Result]<span id="text-time"></span></div>
          <textarea id="text-result"></textarea>
        </div>
      </div>
    </div>
  </body>
</html>
